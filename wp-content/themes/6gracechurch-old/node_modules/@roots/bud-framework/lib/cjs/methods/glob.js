"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.glob = exports.globSync = void 0;
const bud_support_1 = require("@roots/bud-support");
/**
 * Process a bud.path as a glob. Sync version.
 *
 * @remarks
 * Uses fast-glob syntax
 *
 * @public
 */
const globSync = function (...searches) {
    const app = this;
    try {
        const paths = searches.flatMap(search => transformPaths(app, search));
        app.info(`glob (sync)`, `[paths]`, paths);
        const results = bud_support_1.globby.globbySync(paths);
        app.info(`glob (sync)`, `[results]`, results);
        return results;
    }
    catch (error) {
        app.error(error);
    }
};
exports.globSync = globSync;
/**
 * Process a bud.path as a glob.
 *
 * @remarks
 * Uses fast-glob syntax
 *
 * @public
 */
const glob = async function (...searches) {
    const app = this;
    try {
        const paths = searches.flatMap(search => transformPaths(app, search));
        app.info(`glob (async)`, `[paths]`, paths);
        const results = await bud_support_1.globby.globby(paths);
        app.info(`glob (sync)`, `[results]`, results);
        return results;
    }
    catch (error) {
        app.error(error);
    }
};
exports.glob = glob;
const transformPaths = (app, search) => Array.isArray(search)
    ? search.map(item => app.path(item))
    : app.path(search);
